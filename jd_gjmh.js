/*
国际盲盒
活动入口：京东APP首页-京东国际-国际盲盒
活动时间：2021-02-23 - 2021-03-01
因为活动助力方式，找不出比较好的方法解决助力问题，所以默认不助力直接开奖。

后续发布脚本均有加密
因为我介意别人把我脚本里的助力改了。
如果不愿意助力，可以直接下载脚本到本地，通过修改helpAhtor这个参数来关闭助力请求。
请不要修改我的助力。
脚本内置了一个给作者任务助力的网络请求，默认开启，如介意请自行关闭。
助力活动链接： https://h5.m.jd.com/babelDiy/Zeus/4ZK4ZpvoSreRB92RRo8bpJAQNoTq/index.html
参数 helpAuthor = false

更新地址：https://raw.githubusercontent.com/i-chenzhe/qx/main/jd_gjmh.js
已支持IOS双京东账号, Node.js支持N个京东账号
脚本兼容: QuantumultX, Surge, Loon, 小火箭，JSBox, Node.js
============Quantumultx===============
[task_local]
#国际盲盒
10 13 23-28,1 2-3 * https://raw.githubusercontent.com/i-chenzhe/qx/main/jd_gjmh.js, tag=国际盲盒, enabled=true
================Loon==============
[Script]
cron "10 13 23-28,1 2-3 *" script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/jd_gjmh.js, tag=国际盲盒
===============Surge=================
国际盲盒 = type=cron,cronexp="10 13 23-28,1 2-3 *",wake-system=1,timeout=3600,script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/jd_gjmh.js
============小火箭=========
国际盲盒 = type=cron,script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/jd_gjmh.js, cronexpr="10 13 23-28,1 2-3 *", timeout=3600, enable=true
 */
const $ = new Env('国际盲盒');
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
let cookiesArr = [], cookie = '', message;
let helpAuthor = true;
if ($.isNode()) {
    Object.keys(jdCookieNode).forEach((item) => {
        cookiesArr.push(jdCookieNode[item])
    })
    if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => { };
} else {
    let cookiesData = $.getdata('CookiesJD') || "[]";
    cookiesData = JSON.parse(cookiesData);
    cookiesArr = cookiesData.map(item => item.cookie);
    cookiesArr.reverse();
    cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
    cookiesArr.reverse();
    cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
}
!(async () => {
    if (!cookiesArr[0]) {
        $.msg($.name, '【提示】请先获取京东账号一cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/bean/signIndex.action', { "open-url": "https://bean.m.jd.com/bean/signIndex.action" });
        return;
    }
    for (let i = 0; i < cookiesArr.length; i++) {
        if (cookiesArr[i]) {
            cookie = cookiesArr[i];
            $.UserName = decodeURIComponent(cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_pin=(.+?);/)[1])
            $.index = i + 1;
            $.isLogin = true;
            $.nickName = '';
            message = '';
            console.log(`\n******开始【京东账号${$.index}】${$.nickName || $.UserName}*********\n`);
            if (!$.isLogin) {
                $.msg($.name, `【提示】cookie已失效`, `京东账号${$.index} ${$.nickName || $.UserName}\n请重新登录获取\nhttps://bean.m.jd.com/bean/signIndex.action`, { "open-url": "https://bean.m.jd.com/bean/signIndex.action" });
                if ($.isNode()) {
                    await notify.sendNotify(`${$.name}cookie已失效 - ${$.UserName}`, `京东账号${$.index} ${$.UserName}\n请重新登录获取cookie`);
                }
                continue
            }
            await international_mh();
        }
    }
})()
    .catch((e) => {
        $.log('', `❌ ${$.name}, 失败! 原因: ${e}!`, '')
    })
    .finally(() => {
        $.done();
    })
var _0xod2='jsjiami.com.v6',_0xca5a=[_0xod2,'bTIhw4dy','TcOAw4QSE8OFf8OzCMOHJxcww6o+fw==','w4tIbAROw5rDuW/CoQ==','wrQJw5fCpw==','w5PCrcKKwp/Dig==','NgljKT4=','wqjCjcKxBw==','OMKzRQBGRw==','wokUw5Qww6E=','wqstwr9yZ30=','Gm/DplbCuQ==','wqUFw5DCmk0=','wqMpwqV0','wqo4VhXDhMOB','GhzDkQ==','PsKQwpjCt8Kiw7Y=','woFKbSE=','OMK2w7rDv8OQ','XDnCvwA=','FcOIw6DCjxQ=','L8K5w4cNw6M=','DE7DsFHCrw==','w4rDswfCpcOC','NsKtw5XDrsOe','wqE6wrByfnBOFxY=','SgwBQcOjw5zDvgAN','w7jCssKg','wqMWw4HCsW8=','wr3Chmk=','Qh8NQw==','5p+o5q2H6L206KKf5YW46I6W5b2R','XcKDw4VifjJhY8OuwqHCnA==','wrcBwrHDjhZPwowzwoUrw7XDrcKGfmxZa8K7wpFL','ecOmV8OZCQ==','wq47wp5ldns=','w5fCkcKNa8Ko','SxsU','wrjCssOowo00','QMOfw5M=','wrk+URPDocOx','woPCmcOEwoAxw7kATgvDqsOW','wq8NwrzDjBtWwpwpwpE1w60=','GldLaMKLPA==','LMKDw6J8','w73DlA9odUluwo1gw4bCgw==','IFNCbl45','UhM7w4Rv','5oCI5b245Yi95beK5p235p+55oug5b6555q+55ic55qvw7I=','wqAtwqU=','cToMw5YoGA==','N29gKCY/wp3CuSbDjsOvw51PwqRdwovCoMO+w5XDj27DmsKLJwLCimbDl8KGcsOiJjvCnQNtw6/Dp1/Dg3kMRGANwpnDr8OEdBjCq8KXwrDCk8Kb','wrYDw5fCpmVV','NsKgXcOuwoTChiM=','SMOkw5MHSg==','QzXCvxjCvRXCtQ==','wqHCjcK9','w7oNayJ1','T8OWw5E5d8Ol','I11XX8K3','wqFMS3PDow==','KcKgXcOowonClQ==','wqBfwovClQ==','bB7ChQ7Cvw==','BQ/DjsKwKQ==','bCQww6JwwqZrA1kXwphy','wqIBwqY=','wq9zwoTClxY=','w7InTAxm','w5sJEVsKwrrDhcOQTsKXPsK8wowIbcKlw69uCMOHDcOyw7Nfw7QYIMO0w6svHkLDq3XDl8KQI8OAHxoiMBw=','w5pTZiROw5vDvw==','IXh3w6NMwrZmOkU2wr5uQcOt','QSDCqQXCjhfCsyrCjg==','wrFVcA==','wrUFwqDDmBo=','w5xdagw=','aT07w6tYwrx9JlU4woQ=','B31Jal4=','McKsQMO6woHCjjPCsMOvwr7Ckw==','UcOcw4UJacOj','w6DCvMK0acKywr0Jw5o=','LsKLwpTCrsK4w6vCssK1w6rCnA==','wodMaivCkMKHwqjCuEDCsQ==','AsKmb8KPwpc=','L8KkXcO2wqzChQ==','w5FIewBpw5k=','QMOuUXXCimDDszvCjcKkw6bCmArCq8KP','w5ZCFU8twrbDkMOWVMKKDg==','eSHCtBBrwrFefCjCgHLCm8KPw4rDqwxTd8OpE1Nzw7TCoyRlwq3Cm3Fzw7vDoA==','wodCbSHCqMKqwrHCsGvCo8KgwqE=','wqhxcMOo','woFJaWDDiQ==','WsOZw5EJKcODfcOoD8OMOg==','bggNaMO6','PxjDi8KT','AcOWw6w=','6I+/5Yy05Lmt5Yq85Yqv6KGC5aag6LeB44KB','w6PDnBJkQ1N1','w5rDhxZZXw==','w6Buw6I=','w5XCtsKewp7DtcKXesO5wos=','w5BKAksb','w7rDmBJ8cEF+','wpnDjsOPw43CqFM=','McKvw6Akw5E=','w5LClC3CisOBdcKXw6rDlzLDvcOcwrjDtBZGdU1sSV4fwpceVg8mC2LDjMO4fA==','w4HCp8KY','wrUNNQgL','JBbDhQ==','YDsHw70pB8K4wrhA','OMKDw6Ruw50=','cTEmw7lQwqc=','azUmw4NLwr1YGk8lwpJ4F8Ku','KcKFwo3Cog==','w68AbxBPNw==','WcOSw5Yt','AcOWw6xZY8OS','FsKPw6jDjcOQ','6LSl5omj6aKb5oyr77yw5pSz57yQ5ZSO44Ci','w6HDqsOfwqPDgg==','wqlPwpJ6RA==','wqouw5HCoX4=','w4wa6LSB5oiT6aG95o2l77yC5pWI57+H5ZWp44KJ','w4DDuDhNZA==','wpBcwrBCdw==','B8K/VMKOwpRAWcOzw4TClsOYw59LIMKHw5Q=','wqPCgXwiEsOdwpV/wr8=','YDsxw6k=','OsKgw5EE','fyAS','wqRqwoPClB8=','TcORw541Nw==','w6bCuMK0d8KSwqA=','RQ0yT8O9w5LDhQcbKg==','wqLCnH0g','bzsy','PMKfQsO5woc=','WcKIwq9T','wq15asO3','wokSwqjDrDc=','OsKsw5Eaw6kl','e8Kpwo57wo8=','HsKpVGnCg2M=','SB8URw==','BUt0aMKEI8K9SsK+w5Q=','wpPDk8OJw6/Ct0TCk8Ojw78=','JsKzWBJeWw==','MWLCoRI=','woE1w4Yxw6zChw==','D8KrQ8KE','wofDhMOfw6nCqEXCv8O2w6vCn8KrwqEa','RiTCuBvCr0jDv0zCjcKew6DDpHHCmloiw5QHRcKm','wqhVworCgFDDhMKDMcO7IQ==','V8OXw4M8a8Kqw7LCmkrDqDXDnCE3w69zwrtHw49dWSgnVhbDuXPDgMKZwozCmMO/GCMjw4bDusOrw63DlAJ+w70kw55kw51Tw59/w6hFwoBww6zDnsO4DXEiw4fCqcKCUMK3Gj3DiDbDkBrCuHbCizxUPHxMeCzCmi80Y8O2w4wSQRbDqMOGwoQ2ecKLwq7DvMONw5A8wpjCucKbw7zDrmvDmifCm8Kjwo5Vwr3DrMKDRSkQAjLDoFvDvDJLwq5WD8Kywrw3w5rCnMOFwr7DmUfCi1Z9w74fw79Bwq/CvmDCmMKMwrYTw7PDuVbDmULCkMOvHw8ZwrPDgExHLcKhNMOhMSxmw6nCmcOqMsO0w5vCsFIPw7x7J8KvfRXDtMKNw4fDrcKzwoIldsOzMSMpZ3bDkMKLwrHCsy3Ctj4LPA7CrnfCvwIbwqjDpsKtw4LClB7DjsKfH8OLRcKvwqUdw4fDu8O8QCXDhktgwqXChMKlBybCnMO1w4DChDvCtMOWw70/TcO1QcKow4bCvsK5w7HDlBJiwp4Qw7Y9WkMXw6oEHgfDsnlgW8KgW1nCv8K3KWrCkk0Twp7DlkFgwpAww7HCsg==','IA3DlsKXCjpRw5NXUD/DjTPDucOTAMKYNcKdK8O2w4TDtMO2LCoJQBLDmMKtf8KzZMKIwqg=','wqwhSxbCocKlYRzCgcOeVxXCkCTCiQYr','woHChMOewpcmwqxaLx/Dt8OMwqDCmcOgw6hQw5LCrcOxw6zDi8OSwrnDuVdIw4EAwooiw4wVO8Kawpckw6bCpcKbw6LCo1zCnsK6wrZ6','w5PDgMOYw7jCs0XDgMOww6DCvMKgwrMCN8KQZEPDpyXCviDCj8Kaag==','KsKYWsKiwos=','BcO1w4VaeA==','wpTDkcOYw6TCs0LCnMOjw6XCvMKsw70EG8KSax3Cs3fCuTfCn8OMJx/Dl8KvwqbCnMO0dMOcCw==','wqgAwoR+YA==','w5pDXVsQ','w6nCo8Kqwq/DkA==','wqJAwobDnhDCi8KFPMKjJ3RK','CsK6R8KJwoRhV8O/w6DCmMOfwp56Y8KWw4waw6fDhcOKU8KvX2nDsBvDuMOaw452bsKBNw==','w47CtsKYwofDqMOKPMKwwprDsMOqKMKYVz/DshYXwqE=','PmbCsAMywrlEfCrCnA==','wqJAwp/CnBTDhsKOLMOkK3UIwrXCo2DDr8OQOmE9BzJ1Gz3CvMOCJhjCrwzDisKD','wokPEA8zIcKFHMKnQMK5XE1RZsOJw5DCkcK/bMK+wpcPP33Dvmo8fCVzIn3DpsKrwoZhBjfCiMOUFHRSflZfTixuwp/ClMK1YgDCqMK2wq00w7PDmyjDpxIXdjPDrsO1eMO3eQMww6w9cMO8S8Kgw6bCiWZWecKsYcOyw6XDrxzCkiIVwrzCmjDCh8KRw6gOwqjDisK6Cw7Du2TDicKRf8OKwp0hPnY0OijCrMOww4hMwo7DncOrcj8nwpMaImfCkXVEazLChV/CnsKCLRnCiMKYw6VKw6Vcwr3DjGlcw4LCvsKGw4x+w7jDm2gWXx5mw6hnwoXCvTBHwpI2DMOUwqUuwpUqwqTCtMKlW1doO8KkIsK0w67Dgzg9wpcqwqfDqEUEMcKwcsKvEwszen5VFwjDiAjDkgM+w6TDric7Z3IiwqzDgFXDvsOtwot8wqTDvsKBwptowqppCWzDmsKswpHDhcOEw7HDhTFHQsKkw4VhwozCrRTCgMO+S8O4HE3Dm8OCwrDCoGtjInjCnRXCqXdGUcKUNcOFRwgAw5PDlsKONm1ew7fCqw==','GkPCqkHCtg==','Wk4LYcOWNMO0dMOl','ezsBw6Q0WsO+w7FYwoPDoMKYw7/CmQrCkiLDgsKECw94d8OHwowpwozCrMKowqDCqsKJwqvCiB5JGgw=','wrBPwrhnRw==','L8Knw63DrsOT','wqsnwrY=','ZcKAw75Iaw==','wqQqwqNQRA==','wpppYWjDhA==','wpVXfgnCrg==','WMOLw4wvaw==','D8KAw6fDi8Od','wpskw4E0w7PDiXgiQsO9TMKlREVvwocnw6fDrDPCvsK4Z8KBwr/DscKGCD1dScO9w6LDvWYqw6p6w7Arw4Fmwo7DjsOCwrIgPzo1WcOQwqUSw4lDfQlkwqlpNsKfwpoowqjDp8KSUwXDi8Kow5bDmMKmOsOIBsKkIMKYPHvDp8KvL8Oew48Nw4bDgBYowpXClQQARFfCkAnChsOOw7tQBsKZ','H1F8esKW','alXCgMKSCmUMwrJRUDvCnX3DtcKbSMKUMMKdKsK1wpTDosOVNAwdXxrDnsKza8OwPcOTw67CkMOtw6PCuQ==','woXClDnCmsOQbsKxw6rDgGnChMKRw77DrBIfO0h8REFbw40UDFFoVzvCmMK0dcOlw5fCjxclw6XCng5kJ1TCnwo=','TcOcw5E4','VsOiw5EN','w60EbhZG','MVZKRMKS','NjrsgjpPqwHliWamPhEkEiT.com.v6=='];(function(_0x45658b,_0xa6ed42,_0x51c273){var _0x5a2c04=function(_0x12512e,_0x2e9f6a,_0x369b63,_0x3f254c,_0x54c60e){_0x2e9f6a=_0x2e9f6a>>0x8,_0x54c60e='po';var _0x4339f9='shift',_0x17dab4='push';if(_0x2e9f6a<_0x12512e){while(--_0x12512e){_0x3f254c=_0x45658b[_0x4339f9]();if(_0x2e9f6a===_0x12512e){_0x2e9f6a=_0x3f254c;_0x369b63=_0x45658b[_0x54c60e+'p']();}else if(_0x2e9f6a&&_0x369b63['replace'](/[NrgpPqwHlWPhEkET=]/g,'')===_0x2e9f6a){_0x45658b[_0x17dab4](_0x3f254c);}}_0x45658b[_0x17dab4](_0x45658b[_0x4339f9]());}return 0x74428;};return _0x5a2c04(++_0xa6ed42,_0x51c273)>>_0xa6ed42^_0x51c273;}(_0xca5a,0x160,0x16000));var _0x4018=function(_0x5c8032,_0x4473d1){_0x5c8032=~~'0x'['concat'](_0x5c8032);var _0x284c63=_0xca5a[_0x5c8032];if(_0x4018['GlSVPP']===undefined){(function(){var _0x46adad=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x4ea50a='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x46adad['atob']||(_0x46adad['atob']=function(_0x2a32f4){var _0x5460c7=String(_0x2a32f4)['replace'](/=+$/,'');for(var _0xbc4bb5=0x0,_0x877cea,_0x1df609,_0x8c078b=0x0,_0x227abf='';_0x1df609=_0x5460c7['charAt'](_0x8c078b++);~_0x1df609&&(_0x877cea=_0xbc4bb5%0x4?_0x877cea*0x40+_0x1df609:_0x1df609,_0xbc4bb5++%0x4)?_0x227abf+=String['fromCharCode'](0xff&_0x877cea>>(-0x2*_0xbc4bb5&0x6)):0x0){_0x1df609=_0x4ea50a['indexOf'](_0x1df609);}return _0x227abf;});}());var _0x537ab9=function(_0x1d1a73,_0x4473d1){var _0xa77a79=[],_0x406594=0x0,_0x46afce,_0x58b583='',_0x242ce0='';_0x1d1a73=atob(_0x1d1a73);for(var _0x222213=0x0,_0x5de2da=_0x1d1a73['length'];_0x222213<_0x5de2da;_0x222213++){_0x242ce0+='%'+('00'+_0x1d1a73['charCodeAt'](_0x222213)['toString'](0x10))['slice'](-0x2);}_0x1d1a73=decodeURIComponent(_0x242ce0);for(var _0x5d74b7=0x0;_0x5d74b7<0x100;_0x5d74b7++){_0xa77a79[_0x5d74b7]=_0x5d74b7;}for(_0x5d74b7=0x0;_0x5d74b7<0x100;_0x5d74b7++){_0x406594=(_0x406594+_0xa77a79[_0x5d74b7]+_0x4473d1['charCodeAt'](_0x5d74b7%_0x4473d1['length']))%0x100;_0x46afce=_0xa77a79[_0x5d74b7];_0xa77a79[_0x5d74b7]=_0xa77a79[_0x406594];_0xa77a79[_0x406594]=_0x46afce;}_0x5d74b7=0x0;_0x406594=0x0;for(var _0x3790c0=0x0;_0x3790c0<_0x1d1a73['length'];_0x3790c0++){_0x5d74b7=(_0x5d74b7+0x1)%0x100;_0x406594=(_0x406594+_0xa77a79[_0x5d74b7])%0x100;_0x46afce=_0xa77a79[_0x5d74b7];_0xa77a79[_0x5d74b7]=_0xa77a79[_0x406594];_0xa77a79[_0x406594]=_0x46afce;_0x58b583+=String['fromCharCode'](_0x1d1a73['charCodeAt'](_0x3790c0)^_0xa77a79[(_0xa77a79[_0x5d74b7]+_0xa77a79[_0x406594])%0x100]);}return _0x58b583;};_0x4018['DoCXbe']=_0x537ab9;_0x4018['LgfOIK']={};_0x4018['GlSVPP']=!![];}var _0x21b6d5=_0x4018['LgfOIK'][_0x5c8032];if(_0x21b6d5===undefined){if(_0x4018['YrGNAM']===undefined){_0x4018['YrGNAM']=!![];}_0x284c63=_0x4018['DoCXbe'](_0x284c63,_0x4473d1);_0x4018['LgfOIK'][_0x5c8032]=_0x284c63;}else{_0x284c63=_0x21b6d5;}return _0x284c63;};async function international_mh(){var _0x5c7f04={'RjUMq':_0x4018('0','p8M*'),'cbrEW':_0x4018('1','pZQc'),'vSFLw':_0x4018('2','9OU%'),'HmiDp':'gzip,\x20deflate,\x20br','exncp':_0x4018('3','(!Xj'),'PFxVk':_0x4018('4','p8M*'),'gGkHe':_0x4018('5','[Vd1'),'wcDgq':_0x4018('6','Kt@b'),'gpebf':function(_0x23d23e){return _0x23d23e();},'nftKN':'https://api.r2ray.com/jd.bargain/done','WiySm':function(_0x3f1c84,_0x8663a3){return _0x3f1c84<_0x8663a3;},'uZSYC':_0x4018('7','X&r2'),'lvntC':function(_0x55ec46,_0x26fef4,_0x5b5ada){return _0x55ec46(_0x26fef4,_0x5b5ada);},'qgPFN':function(_0x4555af,_0x513444){return _0x4555af===_0x513444;},'lewsw':function(_0x51d791,_0x3a1e9c){return _0x51d791>_0x3a1e9c;},'cEKLw':function(_0x2b15b1,_0x484731){return _0x2b15b1(_0x484731);},'ikJsh':function(_0x449110,_0x1bd859){return _0x449110/_0x1bd859;},'cqLZi':function(_0xb68d6e){return _0xb68d6e();}};if(helpAuthor){function _0x370d5f(){return new Promise(_0x1aa2e5=>{$['get']({'url':_0x4018('8','(wcF')},(_0x3f3754,_0x10aa1b,_0x4759fc)=>{try{if(_0x4759fc){$[_0x4018('9','vHsr')]=JSON[_0x4018('a','9xM$')](_0x4759fc);};}catch(_0x1582cc){console[_0x4018('b','dp!F')](_0x1582cc);}finally{_0x1aa2e5();};});});}function _0xccf883(_0x176534,_0x1c7aac){let _0x179a36={'url':'https://api.m.jd.com/client.action','headers':{'Host':_0x5c7f04[_0x4018('c','$*q0')],'Content-Type':_0x5c7f04[_0x4018('d','dp!F')],'Origin':_0x5c7f04[_0x4018('e','x&UR')],'Accept-Encoding':_0x5c7f04[_0x4018('f','N^Rw')],'Cookie':cookie,'Connection':_0x5c7f04[_0x4018('10','EUQG')],'Accept':_0x5c7f04[_0x4018('11','9xM$')],'User-Agent':_0x5c7f04['gGkHe'],'Referer':_0x4018('12','5dXo')+_0x176534+'&way=0&lng=&lat=&sid=&un_area=','Accept-Language':_0x5c7f04[_0x4018('13','X&r2')]},'body':'functionId=cutPriceByUser&body={\x22activityId\x22:\x22'+_0x176534+_0x4018('14','IbnO')+_0x1c7aac+_0x4018('15','XinQ')};return new Promise(_0x4aad17=>{var _0x4be7e1={'YdrYu':function(_0x16b09c){return _0x16b09c();}};$[_0x4018('16','EUQG')](_0x179a36,(_0x4fd60f,_0x56ff1a,_0x8cf3a7)=>{if(_0x8cf3a7){$[_0x4018('17','0k]r')]=JSON[_0x4018('18','s7Pc')](_0x8cf3a7);_0x4be7e1[_0x4018('19','X&r2')](_0x4aad17);};});});}function _0x17e6c7(_0x2deb5a,_0x3ff11a){var _0x45d592={'uofhQ':function(_0xab2e29){return _0x5c7f04['gpebf'](_0xab2e29);}};let _0x35bf80={'url':_0x5c7f04[_0x4018('1a','wJI7')],'headers':{'Content-Type':_0x4018('1b','0k]r')},'body':JSON[_0x4018('1c','R$G]')]({'actID':_0x2deb5a,'actsID':_0x3ff11a,'done':0x1})};return new Promise(_0x331d68=>{$[_0x4018('1d','B9KZ')](_0x35bf80,(_0x146343,_0xdae49e,_0x5de4a1)=>{_0x45d592[_0x4018('1e','9OU%')](_0x331d68);});});}await _0x370d5f();if($[_0x4018('1f','&N!7')][_0x4018('20','QqCE')][_0x4018('21','E@j5')]!==0x0){for(let _0x2c4359=0x0;_0x5c7f04['WiySm'](_0x2c4359,$[_0x4018('22','5dXo')]['data'][_0x4018('23','dp!F')]);_0x2c4359++){var _0x3da966=_0x5c7f04['uZSYC']['split']('|'),_0x24c655=0x0;while(!![]){switch(_0x3da966[_0x24c655++]){case'0':await $['wait'](0x5dc);continue;case'1':await _0x5c7f04['lvntC'](_0xccf883,actID,actsID);continue;case'2':actID=$[_0x4018('24','Kt@b')][_0x4018('20','QqCE')][_0x2c4359][_0x4018('25','B9KZ')];continue;case'3':actsID=$['zData'][_0x4018('26','dp!F')][_0x2c4359][_0x4018('27','EjaO')];continue;case'4':if($[_0x4018('28','IbnO')]&&_0x5c7f04['qgPFN']($['Res'][_0x4018('29','if)0')],0x4)){await _0x5c7f04['lvntC'](_0x17e6c7,actID,actsID);}continue;}break;}};};};$[_0x4018('2a','J)di')]=![];$['jingdouNums']=0x0;await _0x5c7f04[_0x4018('2b','9xM$')](getHome);if(!$[_0x4018('2c','%OQY')]){await _0x5c7f04[_0x4018('2d','4D!q')](getTaskList);await _0x5c7f04[_0x4018('2e','FZNy')](doTask);await getHome(!![],!![]);if(_0x5c7f04[_0x4018('2f','Kt@b')](_0x5c7f04[_0x4018('30','XinQ')](parseInt,_0x5c7f04[_0x4018('31','9xM$')]($[_0x4018('32','dp!F')],0x5)),0x3)){t=0x3;}else{t=parseInt(_0x5c7f04['ikJsh']($[_0x4018('33','4Bvw')],0x5));}if(t<0x1){console[_0x4018('34','uEYj')]('抽奖次数不足。');}else{for(let _0xd1a395=0x0;_0xd1a395<t;_0xd1a395++){await _0x5c7f04[_0x4018('35','B9KZ')](box);if($['max']){break;}await $['wait'](0x3e8);await openBox();}await _0x5c7f04['cqLZi'](getReward);$[_0x4018('36','[zY&')]($[_0x4018('37','4Bvw')],_0x4018('38','B9KZ')+$[_0x4018('39','$*q0')]+'京豆');}}else{return;}}function getReward(){var _0x593545={'JtHkw':function(_0x2040ce,_0x43e49a){return _0x2040ce(_0x43e49a);},'CLJiV':function(_0x1fc5f5){return _0x1fc5f5();},'QBBja':_0x4018('3a','UekN'),'IxlRl':function(_0x3087a4,_0x4a1b8b){return _0x3087a4===_0x4a1b8b;}};for(let _0x41eb07 of $['rewardBagList']){if(_0x593545['IxlRl'](_0x41eb07['hasRightOpen'],0x1)&&_0x593545[_0x4018('3b','IFLu')](_0x41eb07[_0x4018('3c','dp!F')],0x0)){return new Promise(_0x5e0cec=>{var _0x51a253={'YnSpS':function(_0x32bc0b,_0x33e70a){return _0x593545['JtHkw'](_0x32bc0b,_0x33e70a);},'QGnHS':function(_0x358933){return _0x593545[_0x4018('3d','uEYj')](_0x358933);}};$[_0x4018('3e','4Bvw')](taskUrl_2(_0x593545[_0x4018('3f','##&s')],'{\x22activityCode\x22:\x22lucky-box-001\x22,\x22id\x22:'+_0x41eb07['id']+'}'),(_0x413b73,_0x46fcb5,_0x32b6b5)=>{try{if(_0x413b73){console[_0x4018('40','0k]r')](''+JSON['stringify'](_0x413b73));}else{if(_0x32b6b5){_0x32b6b5=JSON['parse'](_0x32b6b5);if(_0x32b6b5[_0x4018('41','EjaO')]['data'][_0x4018('42','##&s')]!==''){$[_0x4018('43','UekN')]+=_0x51a253['YnSpS'](parseInt,_0x32b6b5[_0x4018('44','X&r2')][_0x4018('45','UNVh')][_0x4018('46','wJY8')]);}}}}catch(_0x4635a9){$[_0x4018('47','6e7!')](_0x4635a9);}finally{_0x51a253[_0x4018('48','wJI7')](_0x5e0cec);}});});}}}function box(){var _0x576591={'uWqKQ':'今日购买已达上限','ghwGV':function(_0x1b521f,_0x13752b){return _0x1b521f===_0x13752b;},'KooBP':_0x4018('49','L(hP'),'MvlWP':function(_0x3af9c3){return _0x3af9c3();},'NSSsk':function(_0x594250,_0xa3e650){return _0x594250===_0xa3e650;},'BNIec':function(_0x4d0db8,_0x50dfe2,_0x378dfa){return _0x4d0db8(_0x50dfe2,_0x378dfa);}};return new Promise(_0x10e9a0=>{$[_0x4018('4a','dp!F')](taskUrl_2(_0x4018('4b','(wcF'),_0x4018('4c','&N!7')),async(_0x553bf7,_0x388a33,_0x34b39e)=>{try{if(_0x553bf7){console[_0x4018('b','dp!F')](''+JSON['stringify'](_0x553bf7));}else{if(_0x34b39e){_0x34b39e=JSON['parse'](_0x34b39e);if(_0x34b39e[_0x4018('4d','B9KZ')][_0x4018('4e','yRWc')]===_0x576591[_0x4018('4f','EUQG')]){console['log'](_0x34b39e['result'][_0x4018('50','%OQY')]);$[_0x4018('51','QqCE')]=!![];return;}if(_0x576591[_0x4018('52','s7Pc')](_0x34b39e[_0x4018('53','EUQG')]['message'],_0x576591[_0x4018('54','X&r2')])){await _0x576591[_0x4018('55','x&UR')](openBox);}if(_0x576591['NSSsk'](_0x34b39e[_0x4018('56','yRWc')][_0x4018('57','p8M*')],'0')){await _0x576591[_0x4018('58','%OQY')](getHome,![],!![]);}}}}catch(_0x444115){$['logErr'](_0x444115);}finally{_0x576591[_0x4018('59','IbnO')](_0x10e9a0);}});});}function openBox(){var _0x488c04={'FurWs':function(_0x4b8bb0,_0x3f5cd3){return _0x4b8bb0(_0x3f5cd3);},'lCkgk':function(_0x48a000,_0x28c78e,_0x1501f0){return _0x48a000(_0x28c78e,_0x1501f0);},'oBPiE':_0x4018('5a','wJI7')};return new Promise(_0x54fcb5=>{var _0x225a86={'vcvyG':function(_0x4c1183,_0x375e18){return _0x4c1183!==_0x375e18;},'KAlAr':function(_0x370abc,_0x45072c){return _0x488c04['FurWs'](_0x370abc,_0x45072c);}};$[_0x4018('5b','UekN')](_0x488c04[_0x4018('5c','p8M*')](taskUrl_2,_0x488c04[_0x4018('5d','s7Pc')],_0x4018('5e','L(hP')+$[_0x4018('5f','R$G]')]['orderNo']+_0x4018('60','wJI7')+$['boxInfo'][_0x4018('61','%OQY')]+'}'),(_0x448b8e,_0xe14228,_0x581ca8)=>{try{if(_0x448b8e){console[_0x4018('62','N^Rw')](''+JSON['stringify'](_0x448b8e));}else{if(_0x581ca8){_0x581ca8=JSON[_0x4018('63','UekN')](_0x581ca8);if(_0x225a86['vcvyG'](_0x581ca8[_0x4018('53','EUQG')][_0x4018('64','R$G]')]['jingdouNums'],'')){$[_0x4018('65','wJI7')]+=_0x225a86[_0x4018('66','6e7!')](parseInt,_0x581ca8['result']['data'][_0x4018('67','yRWc')]);}}}}catch(_0x225b22){$[_0x4018('68','EUQG')](_0x225b22);}finally{_0x54fcb5();}});});}async function doTask(){var _0x4fec61={'ilXjz':function(_0x11dc79,_0x3c66da){return _0x11dc79<_0x3c66da;},'msNDz':function(_0x285551,_0x7a6edb){return _0x285551*_0x7a6edb;},'BvmNt':function(_0x3a8716,_0x36e56e){return _0x3a8716(_0x36e56e);}};let _0x5a82b5=$[_0x4018('69','uEYj')][_0x4018('6a','if)0')];if(_0x5a82b5){for(let _0xab7dc of _0x5a82b5){let _0x3dd730=_0xab7dc[_0x4018('6b','J)di')]-_0xab7dc['executedTimes'];if(_0x3dd730!==0x0){for(let _0x39f49c=0x0;_0x4fec61[_0x4018('6c','pZQc')](_0x39f49c,_0x3dd730);_0x39f49c++){let _0x43a050='{\x22taskId\x22:'+_0xab7dc[_0x4018('6d','yRWc')]+',\x22itemId\x22:'+_0xab7dc[_0x4018('6e','R$G]')]+_0x4018('6f','g)Rq')+_0xab7dc[_0x4018('70','L(hP')]+_0x4018('71','(!Xj');console['log'](_0xab7dc[_0x4018('72','J)di')]+'\x20-\x20'+_0xab7dc['taskName']);await $[_0x4018('73','mN$K')](_0x4fec61[_0x4018('74','x&UR')](_0xab7dc[_0x4018('75','0k]r')],0x1f4));await _0x4fec61[_0x4018('76','4Bvw')](taskRun,_0x43a050);await $[_0x4018('77','IbnO')](0x3e8);}}}}else{console[_0x4018('78','sS0N')](_0x4018('79','UNVh'));}}function taskRun(_0x5b7fd1){var _0x4f9db2={'yfBKT':function(_0x2bd48c){return _0x2bd48c();},'tqsEz':function(_0x11ad9d,_0x240da1,_0x3b2709){return _0x11ad9d(_0x240da1,_0x3b2709);},'MzwVN':_0x4018('7a','wJY8')};return new Promise(_0xfad98f=>{$['get'](_0x4f9db2['tqsEz'](taskUrl_2,_0x4f9db2[_0x4018('7b','wJY8')],_0x5b7fd1),(_0x171aa2,_0x3afa0d,_0x1d83c6)=>{try{if(_0x171aa2){console[_0x4018('7c','9GwC')](''+JSON[_0x4018('7d','9OU%')](_0x171aa2));}else{if(_0x1d83c6){_0x1d83c6=JSON[_0x4018('7e','L(hP')](_0x1d83c6);console['log'](_0x1d83c6[_0x4018('56','yRWc')][_0x4018('7f','wJY8')]);}}}catch(_0x8c2a43){$[_0x4018('80','^JDa')](_0x8c2a43);}finally{_0x4f9db2[_0x4018('81','FZNy')](_0xfad98f);}});});}function getTaskList(){var _0x1111d3={'IIwPf':function(_0xcb2b7){return _0xcb2b7();},'VfDwH':function(_0x54e4d6,_0x415f94,_0x45a39a){return _0x54e4d6(_0x415f94,_0x45a39a);}};let _0x26fd5b=_0x4018('82','XinQ');return new Promise(_0x1f4a95=>{$[_0x4018('83','9OU%')](_0x1111d3[_0x4018('84','[Vd1')](taskUrl_2,'myTask',_0x26fd5b),(_0x27d0dd,_0x4585de,_0x2de229)=>{try{if(_0x27d0dd){console[_0x4018('85','IbnO')](''+JSON[_0x4018('86','(wcF')](_0x27d0dd));}else{if(_0x2de229){_0x2de229=JSON[_0x4018('87','UNVh')](_0x2de229);if(_0x2de229[_0x4018('88','wJI7')][_0x4018('89','wJI7')](_0x4018('8a','if)0'))){$['taskList']=_0x2de229[_0x4018('8b','s7Pc')][_0x4018('8c','EUQG')];}}}}catch(_0x1c294a){$[_0x4018('8d','sS0N')](_0x1c294a);}finally{_0x1111d3[_0x4018('8e','9xM$')](_0x1f4a95);}});});}function getHome(_0x891de4=![],_0x44347c=![]){var _0x55f6a4={'OpnUm':_0x4018('8f','wJI7'),'cDKib':function(_0x5ee5f2,_0x3c719b){return _0x5ee5f2===_0x3c719b;},'nHurw':function(_0x175cbc,_0x3fa4a2){return _0x175cbc+_0x3fa4a2;},'WEYBu':function(_0x1e8957){return _0x1e8957();},'ZWiQQ':function(_0x547fa7,_0x22873b,_0x54b10d){return _0x547fa7(_0x22873b,_0x54b10d);}};let _0x5731d5='{\x22applicationId\x22:\x2227260146\x22,\x22activityCode\x22:\x22lucky-box-001\x22,\x22boxId\x22:\x221\x22}';return new Promise(_0x57293a=>{var _0x350e15={'MTTow':function(_0x34fa0e,_0x522884){return _0x34fa0e===_0x522884;},'gZldb':_0x55f6a4[_0x4018('90','9Dkm')],'aajKM':function(_0x4a48f7,_0x52ab8b){return _0x55f6a4[_0x4018('91','vHsr')](_0x4a48f7,_0x52ab8b);},'LvzGH':function(_0x33a295,_0x2b8114){return _0x55f6a4[_0x4018('92','B9KZ')](_0x33a295,_0x2b8114);},'ANEMo':_0x4018('93','x&UR'),'VFaUH':function(_0x1dfda6){return _0x55f6a4[_0x4018('94','wJY8')](_0x1dfda6);}};$['get'](_0x55f6a4[_0x4018('95','vHsr')](taskUrl_2,_0x4018('96','pZQc'),_0x5731d5),(_0xf78b24,_0x53972f,_0x889e42)=>{try{if(_0xf78b24){console['log'](''+JSON[_0x4018('97','[zY&')](_0xf78b24));}else{if(_0x889e42){_0x889e42=JSON[_0x4018('7e','L(hP')](_0x889e42);if(_0x350e15['MTTow'](_0x889e42[_0x4018('98','wJI7')],'3')){$[_0x4018('99','FZNy')]=!![];console[_0x4018('9a','(wcF')](_0x350e15[_0x4018('9b','p8M*')]);return;}if(_0x350e15[_0x4018('9c','0k]r')](_0x889e42[_0x4018('9d','uEYj')]['data'][_0x4018('9e','4Bvw')],0x1)){$[_0x4018('9f','[zY&')]=!![];console[_0x4018('a0','wJI7')](_0x350e15[_0x4018('a1','yRWc')]);return;}if(_0x889e42[_0x4018('4d','B9KZ')][_0x4018('a2','b0iV')]==='2'){$[_0x4018('a3','mN$K')]=!![];console['log'](_0x350e15[_0x4018('a4','UekN')](_0x889e42[_0x4018('a5','FZNy')]['message'],_0x350e15[_0x4018('a6','b0iV')]));return;}if(_0x891de4){$[_0x4018('33','4Bvw')]=_0x889e42[_0x4018('a7','g)Rq')][_0x4018('a8','4Bvw')][_0x4018('a9','X&r2')][_0x4018('aa','^JDa')];}if(_0x44347c){$['boxInfo']=_0x889e42[_0x4018('ab','E@j5')][_0x4018('ac','(!Xj')]['luckyBoxList'][0x0];$['rewardBagList']=_0x889e42[_0x4018('ad','5dXo')][_0x4018('ae','pZQc')][_0x4018('af','^JDa')];}}}}catch(_0x5a3e7a){$['logErr'](_0x5a3e7a);}finally{_0x350e15['VFaUH'](_0x57293a);}});});}function taskUrl_2(_0x42e44a,_0x3fe93){var _0x4c3db2={'ARmGf':function(_0x52683b,_0x28562e){return _0x52683b(_0x28562e);},'hLNFi':'api.m.jd.com','rrpBC':_0x4018('b0','%OQY'),'ilEhQ':_0x4018('b1','p8M*'),'oHUks':_0x4018('b2','EUQG'),'OaFXK':_0x4018('b3','IbnO'),'pbPBq':_0x4018('b4','EjaO')};return{'url':_0x4018('b5','##&s')+_0x42e44a+_0x4018('b6','^JDa')+_0x4c3db2[_0x4018('b7','pZQc')](encodeURIComponent,_0x3fe93),'headers':{'Host':_0x4c3db2[_0x4018('b8','sS0N')],'Origin':_0x4c3db2['rrpBC'],'Connection':_0x4c3db2['ilEhQ'],'Accept':_0x4018('b9','^JDa'),'User-Agent':_0x4c3db2[_0x4018('ba','dp!F')],'Accept-Language':_0x4018('bb','L(hP'),'Referer':_0x4c3db2[_0x4018('bc','9OU%')],'Accept-Encoding':_0x4c3db2['pbPBq'],'Cookie':cookie}};};_0xod2='jsjiami.com.v6';
function Env(t, e) { class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `\ud83d\udd14${this.name}, \u5f00\u59cb!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), a = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(a, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t) { let e = { "M+": (new Date).getMonth() + 1, "d+": (new Date).getDate(), "H+": (new Date).getHours(), "m+": (new Date).getMinutes(), "s+": (new Date).getSeconds(), "q+": Math.floor(((new Date).getMonth() + 3) / 3), S: (new Date).getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, ((new Date).getFullYear() + "").substr(4 - RegExp.$1.length))); for (let s in e) new RegExp("(" + s + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? e[s] : ("00" + e[s]).substr(("" + e[s]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t.stack) : this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
